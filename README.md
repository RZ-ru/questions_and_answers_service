# üß© Q&A Service ‚Äî API –¥–ª—è –≤–æ–ø—Ä–æ—Å–æ–≤ –∏ –æ—Ç–≤–µ—Ç–æ–≤

–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ —Å–µ—Ä–≤–∏—Å –≤–æ–ø—Ä–æ—Å–æ–≤ –∏ –æ—Ç–≤–µ—Ç–æ–≤. –¶–µ–ª—å —ç—Ç–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞ ‚Äî –ø—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –≥—Ä–∞–º–æ—Ç–Ω—É—é –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—é —Å–ª–æ—ë–≤, –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ ORM, –æ–±—Ä–∞–±–æ—Ç–∫—É –∑–∞–ø—Ä–æ—Å–æ–≤ —á–µ—Ä–µ–∑ —É—Å—Ç–æ–π—á–∏–≤—ã–π HTTP‚Äë—Å–ª–æ–π –∏ –ø–æ–ª–Ω–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ –º–µ–∂–¥—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏.

–°–µ—Ä–≤–∏—Å –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ø—Ä–æ—Å—Ç–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –¥–∞–Ω–Ω—ã–º–∏, —Å–æ–¥–µ—Ä–∂–∏—Ç –≤–∞–ª–∏–¥–∞—Ü–∏—é, –∫–∞—Å–∫–∞–¥–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏, –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ, —Ç–µ—Å—Ç—ã –∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—é. README –æ—Ç—Ä–∞–∂–∞–µ—Ç —Ä–µ–∞–ª—å–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø—Ä–æ–µ–∫—Ç–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤.

–ü–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π REST API –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–æ–ø—Ä–æ—Å–∞–º–∏ –∏ –æ—Ç–≤–µ—Ç–∞–º–∏, –æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–π –Ω–∞ Go, PostgreSQL –∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ —Ä–∞–∑–¥–µ–ª—ë–Ω–Ω—ã—Ö —Å–ª–æ—ë–≤. README –æ–±–Ω–æ–≤–ª—ë–Ω —Å —É—á—ë—Ç–æ–º —Ä–µ–∞–ª—å–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π, –º–∏–≥—Ä–∞—Ü–∏–π, —Å–µ—Ä–≤–∏—Å–æ–≤ –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ø—Ä–æ–µ–∫—Ç–∞.







–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–∞–∑–¥–µ–ª–µ–Ω–∞ –Ω–∞ —Å–ª–æ–∏: **handlers ‚Üí services ‚Üí repository**.\
–ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è: **Go, GORM, PostgreSQL, goose, Docker, docker-compose, —Ç–µ—Å—Ç—ã.**

---

# üöÄ –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫

–ù–∏–∂–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã —Å–ø–æ—Å–æ–±—ã –∑–∞–ø—É—Å–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞: —á–µ—Ä–µ–∑ Docker –∏ –ª–æ–∫–∞–ª—å–Ω–æ –±–µ–∑ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏–∏.

–ù–∏–∂–µ –ø—Ä–∏–≤–µ–¥–µ–Ω—ã —Å–ø–æ—Å–æ–±—ã –∑–∞–ø—É—Å–∫–∞: —á–µ—Ä–µ–∑ Docker –∏ –ª–æ–∫–∞–ª—å–Ω–æ –±–µ–∑ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏–∏.

## 1Ô∏è‚É£ –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–µ–∫—Ç

```bash
git clone https://github.com/RZ-ru/questions_and_answers_service
cd questions_and_answers_service
```

## 2Ô∏è‚É£ –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤–µ—Å—å —Å–µ—Ä–≤–∏—Å

```bash
docker compose up --build
```

## üîß –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ –±–µ–∑ Docker

–¢—Ä–µ–±—É–µ—Ç—Å—è —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–π Go –∏ PostgreSQL.

1. –°–æ–∑–¥–∞–π—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö:

```sql
CREATE DATABASE qna_db;
```

2. –ü—Ä–∏–º–µ–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –≤—Ä—É—á–Ω—É—é:

```bash
goose -dir ./migrations postgres "host=localhost user=postgres password=postgres dbname=qna_db sslmode=disable" up
```

3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:

```bash
go run ./cmd/qa_service/main.go
```

###–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ API –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ –∞–¥—Ä–µ—Å—É:

[http://localhost:8080](http://localhost:8080)

## 3Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∏–≥—Ä–∞—Ü–∏–π –≤—Ä—É—á–Ω—É—é (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

```bash
docker exec -it qna_app \
goose -dir ./migrations postgres \
"host=db user=postgres password=postgres dbname=qna_db sslmode=disable" up
```

---

# üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
cmp/
‚îî‚îÄ‚îÄ qa_service/
    ‚îî‚îÄ‚îÄ main.go

internal/
‚îú‚îÄ‚îÄ handlers/
‚îÇ   ‚îú‚îÄ‚îÄ answers.go
‚îÇ   ‚îú‚îÄ‚îÄ middleware.go
‚îÇ   ‚îî‚îÄ‚îÄ questions.go
‚îú‚îÄ‚îÄ logger/
‚îÇ   ‚îî‚îÄ‚îÄ logger.go
‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îú‚îÄ‚îÄ answers_model.go
‚îÇ   ‚îî‚îÄ‚îÄ questions_model.go
‚îú‚îÄ‚îÄ repository/
‚îÇ   ‚îú‚îÄ‚îÄ answers_repo.go
‚îÇ   ‚îú‚îÄ‚îÄ db.go
‚îÇ   ‚îú‚îÄ‚îÄ questions_repo.go
‚îÇ   ‚îî‚îÄ‚îÄ repository.go
‚îî‚îÄ‚îÄ services/
    ‚îú‚îÄ‚îÄ answers_service.go
    ‚îú‚îÄ‚îÄ interfaces.go
    ‚îî‚îÄ‚îÄ questions_service.go

migrations/
‚îú‚îÄ‚îÄ 0001_create_questions.sql
‚îî‚îÄ‚îÄ 0002_create_answers.sql

tests/
‚îú‚îÄ‚îÄ handlers_test/
‚îÇ   ‚îú‚îÄ‚îÄ answers_handler_test.go
‚îÇ   ‚îî‚îÄ‚îÄ questions_handler_test.go
‚îî‚îÄ‚îÄ services_test/
    ‚îú‚îÄ‚îÄ answer_service_test.go
    ‚îú‚îÄ‚îÄ mocks_test.go
    ‚îî‚îÄ‚îÄ question_service_test.go

.env
.env.docker
.env.docker.example
.env.example
docker-compose.yml
Dockerfile
go.mod
go.sum
README.md
```

---

# üß± –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### ‚úî `cmd/qa_service/main.go`

–¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞: –∑–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥–æ–≤, –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –ë–î, –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–µ—Ä–≤–∏—Å–æ–≤, HTTP-—Ä–æ—É—Ç–µ—Ä.

### ‚úî Handlers (`internal/handlers`)

–û–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç HTTP-–∑–∞–ø—Ä–æ—Å—ã. –ù–∏–∫–∞–∫–æ–π –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏.

### ‚úî Services (`internal/services`)

–°–æ–¥–µ—Ä–∂–∞—Ç –ø—Ä–∞–≤–∏–ª–∞:

- –≤–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –∑–∞–ø—Ä–µ—Ç —Å–æ–∑–¥–∞–≤–∞–Ω–∏—è –æ—Ç–≤–µ—Ç–∞ –∫ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º—É –≤–æ–ø—Ä–æ—Å—É
- —É–¥–∞–ª–µ–Ω–∏–µ –≤–æ–ø—Ä–æ—Å–∞ ‚Üí –∫–∞—Å–∫–∞–¥–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç–æ–≤
- –æ–±—ë—Ä—Ç–∫–∞ –Ω–∞–¥ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è–º–∏

### ‚úî Repository (`internal/repository`)

–í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –≤ PostgreSQL —á–µ—Ä–µ–∑ GORM.

### ‚úî Models (`internal/models`)

–°—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö (Question, Answer).

### ‚úî –ú–∏–≥—Ä–∞—Ü–∏–∏ (`migrations`)

`0001_create_questions.sql`\
`0002_create_answers.sql`\
–í–∫–ª—é—á–∞–µ—Ç¬†**ON DELETE CASCADE**.

---

# üóÑ –°—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

–°—Ö–µ–º–∞ –æ—Ç—Ä–∞–∂–∞–µ—Ç —Ä–µ–∞–ª—å–Ω—ã–µ –º–æ–¥–µ–ª–∏ –ø—Ä–æ–µ–∫—Ç–∞. –ü–æ–ª–µ `user_id` –¥–æ–ø—É—Å–∫–∞–µ—Ç —Å—Ç—Ä–æ–∫–∏ –ª—é–±–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞ ‚Äî –Ω–∞–ø—Ä–∏–º–µ—Ä UUID (`"a57e1e1f-f50a-4a39-9da7-119b4c0fa0ac"`).

–°—Ö–µ–º–∞ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∞ –ø–æ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–º –º–æ–¥–µ–ª—è–º (`uint` –≤–º–µ—Å—Ç–æ SERIAL, `TEXT` –¥–ª—è `user_id`).

### üìå –¢–∞–±–ª–∏—Ü–∞ `questions`

| –ü–æ–ª–µ        | –¢–∏–ø       |
| ----------- | --------- |
| id          | BIGINT / uint |
| text        | TEXT      |
| created\_at | TIMESTAMP |

### üìå –¢–∞–±–ª–∏—Ü–∞ `answers`

| –ü–æ–ª–µ         | –¢–∏–ø       |
| ------------ | --------- |
| id          | BIGINT / uint |
| question\_id | INT (FK)  |
| user\_id     | TEXT      |
| text         | TEXT      |
| created\_at  | TIMESTAMP |

FK –Ω–∞—Å—Ç—Ä–æ–µ–Ω:

```
ON DELETE CASCADE
```

---

# üß™ –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤ API

### üìç –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –≤–æ–ø—Ä–æ—Å–æ–≤

```
GET /questions/
```

### üìç –°–æ–∑–¥–∞—Ç—å –≤–æ–ø—Ä–æ—Å

```
POST /questions/
Content-Type: application/json

{
  "text": "–ö–∞–∫–∞—è —Å—Ç–æ–ª–∏—Ü–∞ –®–≤–µ—Ü–∏–∏?"
}
```

### üìç –ü–æ–ª—É—á–∏—Ç—å –≤–æ–ø—Ä–æ—Å + –æ—Ç–≤–µ—Ç—ã

```
GET /questions/5
```

### üìç –£–¥–∞–ª–∏—Ç—å –≤–æ–ø—Ä–æ—Å —Å–æ –≤—Å–µ–º–∏ –æ—Ç–≤–µ—Ç–∞–º–∏ –∫ –Ω–µ–º—É

```
DELETE /questions/5
```

---

### üìç –î–æ–±–∞–≤–∏—Ç—å –æ—Ç–≤–µ—Ç –∫ –≤–æ–ø—Ä–æ—Å—É

```
POST /questions/5/answers/
Content-Type: application/json

{
  "user_id": "a57e1e1f-f50a-4a39-9da7-119b4c0fa0ac",
  "text": "–°—Ç–æ–∫–≥–æ–ª—å–º"
}
```

–ï—Å–ª–∏ –≤–æ–ø—Ä–æ—Å –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç ‚Üí –æ—à–∏–±–∫–∞.

### üìç –ü–æ–ª—É—á–∏—Ç—å –æ—Ç–≤–µ—Ç

```
GET /answers/3
```

### üìç –£–¥–∞–ª–∏—Ç—å –æ—Ç–≤–µ—Ç

```
DELETE /answers/3
```

---

# ‚úî –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞

| –¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ                               | –°—Ç–∞—Ç—É—Å |
| ---------------------------------------- | ------ |
| –ú–∏–≥—Ä–∞—Ü–∏–∏ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è                     | ‚úÖ      |
| –ö–∞—Å–∫–∞–¥–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç              | ‚úÖ      |
| –û—Ç–≤–µ—Ç –∫ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º—É –≤–æ–ø—Ä–æ—Å—É –∑–∞–ø—Ä–µ—â—ë–Ω | ‚úÖ      |
| docker-compose –ø–æ–¥–Ω–∏–º–∞–µ—Ç –ë–î + —Å–µ—Ä–≤–∏—Å     | ‚úÖ      |
| –¢–µ—Å—Ç—ã –¥–ª—è handlers/services              | ‚úÖ      |
| –ü—Ä–æ–µ–∫—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω                    | ‚úÖ      |

---

# üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

–ù–∏–∂–µ –ø—Ä–∏–≤–µ–¥—ë–Ω –ø–æ–ª–Ω—ã–π –∏ –∏—Ç–æ–≥–æ–≤—ã–π —Å–ø–∏—Å–æ–∫ –º–æ–¥—É–ª–µ–π, —Ä–µ–∞–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –≤ –ø—Ä–æ–µ–∫—Ç–µ:

- **Go** ‚Äî –æ—Å–Ω–æ–≤–Ω–æ–π —è–∑—ã–∫ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- **net/http** ‚Äî HTTP‚Äë—Å–µ—Ä–≤–µ—Ä
- **chi (github.com/go-chi/chi/v5)** ‚Äî –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è
- **zerolog (github.com/rs/zerolog)** ‚Äî —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- **godotenv (github.com/joho/godotenv)** ‚Äî –∑–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏–∑ .env
- **GORM (gorm.io/gorm)** ‚Äî ORM
- **PostgreSQL driver (gorm.io/driver/postgres)** ‚Äî –¥—Ä–∞–π–≤–µ—Ä –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- **goose** ‚Äî –º–∏–≥—Ä–∞—Ü–∏–∏ –ë–î
- **Docker / docker-compose** ‚Äî –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è
- **testify / httptest** ‚Äî –º–æ–¥—É–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–≠—Ç–∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å, —á–∏—Ç–∞–µ–º–æ—Å—Ç—å –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å –ø—Ä–æ–µ–∫—Ç–∞.

---

# ‚≠ê –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —Ä–µ—à–µ–Ω–∏—è

- **–ß—ë—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Å–ª–æ—ë–≤**: handlers ‚Üí services ‚Üí repository
- **–ü–æ–Ω—è—Ç–Ω—ã–µ –º–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö**, –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –º–∏–≥—Ä–∞—Ü–∏—è–º
- **–†–∞—Å—à–∏—Ä—è–µ–º–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** ‚Äî –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏ –∏–ª–∏ —Å–µ—Ä–≤–∏—Å—ã
- **–ü—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** —á–µ—Ä–µ–∑ zerolog
- **–Æ–Ω–∏—Ç‚Äë—Ç–µ—Å—Ç—ã —Å–µ—Ä–≤–∏—Å–æ–≤** —Å –º–æ–∫–∞–º–∏
- **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏–π —á–µ—Ä–µ–∑ .env**
- **–ö–∞—Å–∫–∞–¥–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è** –≤—Å—Ç—Ä–æ–µ–Ω—ã –Ω–∞ —É—Ä–æ–≤–Ω–µ —Å–µ—Ä–≤–∏—Å–æ–≤
- **–î–æ–∫–µ—Ä–∏–∑–∞—Ü–∏—è** –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –µ–¥–∏–Ω—ã–π —Ä–∞–±–æ—á–∏–π –∑–∞–ø—É—Å–∫ –Ω–∞ –ª—é–±–æ–π –º–∞—à–∏–Ω–µ

---

# üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License

